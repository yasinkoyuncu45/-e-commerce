@model IEnumerable<Category>

@{
	ViewData["Title"] = "Index";
	Layout = "~/Views/Shared/AdminLayout.cshtml";
	Context con = new Context();
	string CategoryName = "";

}
<div class="row">
	<div class="col-md-2 col-xs-12 col-sm-12 col-lg-2"></div>

	<div class="col-md-8 col-xs-12 col-sm-12 col-lg-8">
		<p>
			<a asp-action="CategoryCreate" asp-controller="Admin" class="btn btn-success">YENİ KATEGORİ</a>

			@* <a href="/Admin/CategoryCreate" class="btn btn-success">YENİ KATEGORİ</a> *@
		</p>

		<!-- BEGIN SAMPLE TABLE PORTLET-->
		<div class="portlet box red">
			<div class="portlet-title">
				<div class="caption">
					<i class="fa fa-cogs"></i>KATEGORİ LİSTESİ
				</div>
				<div class="tools">
					<a href="javascript:;" class="collapse">
					</a>
					<a href="#portlet-config" data-toggle="modal" class="config">
					</a>
					<a href="javascript:;" class="reload">
					</a>
					<a href="javascript:;" class="remove">
					</a>
				</div>
			</div>
			<div class="portlet-body">
				<div class="table-scrollable">
					<table class="table table-hover">
						<thead>
							<tr style="background-color:grey;color:white">
								<th>
									@Html.DisplayNameFor(model => model.CategoryID)
								</th>
								<th>
									@Html.DisplayNameFor(model => model.CategoryName)
								</th>
								<th>
									@Html.DisplayNameFor(model => model.ParentID)
								</th>
								<th>
									@Html.DisplayNameFor(model => model.Active)
								</th>

								<th></th>


							</tr>
						</thead>
						<tbody>

							@foreach (var item in Model.Where(c => c.ParentID == 0))
							{
								<tr>
									<td>
										@Html.DisplayFor(model => item.CategoryID)
									</td>
									<td>
										<span style="background-color:black;color:white;font-size:20px;">
											@Html.DisplayFor(model => item.CategoryName)
										</span>

									</td>
									<td>
										@if (item.ParentID == 0)
										{
											<label>ANA KATEGORİ</label>
										}
										else
										{
											<label>
												Alt Kategori
											</label>
										}
									</td>
									@if (item.Active)
									{
										<td style="background-color:green;color:white;">
											<label>AKTİF</label>
										</td>
									}
									else
									{
										<td style="background-color:red;color:white;">
											<label>PASİF</label>
										</td>
									}

									<td>
										<a asp-action="CategoryEdit" asp-route-id="@item.CategoryID" class="btn btn-primary">DÜZELT</a>
										<a asp-action="CategoryDetails" asp-route-id="@item.CategoryID" class="btn btn-info">DETAY</a>
										<a asp-action="CategoryDelete" asp-route-id="@item.CategoryID" class="btn btn-danger">SİL</a>
									</td>

								</tr>
								@foreach (var subitem in Model)
								{
									if (item.CategoryID == subitem.ParentID)
									{
										//buraya gelirse alt kategoriler var demektir.
										<tr>
											<td>
												@Html.DisplayFor(model => subitem.CategoryID)
											</td>
											<td>
												@Html.DisplayFor(model => subitem.CategoryName)
											</td>
											<td>
												@if (subitem.ParentID == 0)
												{
													<label>ANA KATEGORİ</label>
												}
												else
												{
													<label>
														Alt Kategori
													</label>
												}
											</td>
											@if (subitem.Active)
											{
												<td style="background-color:green;color:white;">
													<label>AKTİF</label>
												</td>
											}
											else
											{
												<td style="background-color:red;color:white;">
													<label>PASİF</label>
												</td>
											}

											<td>
												<a asp-action="CategoryEdit" asp-route-id="@subitem.CategoryID" class="btn btn-primary">DÜZELT</a>
												<a asp-action="CategoryDetails" asp-route-id="@subitem.CategoryID" class="btn btn-info">DETAY</a>
												<a asp-action="CategoryDelete" asp-route-id="@subitem.CategoryID" class="btn btn-danger">SİL</a>
											</td>

										</tr>
									}
								}
							}


						</tbody>
					</table>
				</div>
			</div>
		</div>
		<!-- END SAMPLE TABLE PORTLET-->
	</div>

</div>